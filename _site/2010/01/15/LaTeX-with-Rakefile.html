<!DOCTYPE html>
<html>
  <head>
    <title>WYSIWYG in LaTeX with Rakefile</title>
  </head>

  <body>
    <div id="content">
      <h1>WYSIWYG in LaTeX with Rakefile</h1>
      <p>First tools to work with text I have learned where WYSIWYG and everywhere I looked they were praised. I really did not know the alternative and could not think a reason for it to exist in time of fast computers. But when I was exposed to LaTex I have instantly fell in love. Compared to Word it produces astonishingly beautiful output, takes whole of issues away (numbering, chapters, pages with one sentence on it, positioning pictures and many, many more) and lets you focus on content (and structure) not on the final look (just like WriteBoard, I am using right now). But it has some issues. Actually my relationship with LaTeX is more like love-hate one. Sooner or later you will want to do some non-trivial thing to do. And you will either have to dig really deeply or find someone who did it before - and neither one may be easy, even with google on you back. But knowing many its faults I still do know imagine writing a thesis in some word processor instead of LaTeX - that would be just plain stupid&#8230;</p>

<p>I would like to share with you a simple script that makes life with LaTeX a little nicer. It is a Rakefile, so you need to have Ruby and Rake gem installed. It contains some simple tasks:</p>

<ul>
<li>compile - creates PDF document from the source files. It makes a couple of runs too much, but just to be sure that everything is on the right place, with bibliography, table of content, etc.</li>

<li>clean - deletes all the messy and unneeded files if you would like to zip folder and send it somewhere.</li>

<li>view - tries to display PDF in some reader available on your system.</li>

<li>run - the most interesting part. I have stolen a concept from autotest. It checks the source files every second and if there are any changes it runs compile. If you have a sane PDF reader (like Sumatra on Windows, or Skim on Mac - not Adobe Reader) then it will refresh pdf as soon as it is ready. So you can have this rake task running in the background, and every time you hit save you will see changes in the pdf.</li>
</ul>

<p>I consider this to be the best of both worlds. You can write freely for most time, but when you are finishing and want to take care of the final look you can almost instantly see changes in PDF and tweek quirks until you are satisfied.</p>

<p>There are other tools to acomplish similar results. One of them is LyX, but there is a problem with retrieving source tex files from it. And you will need them at some point, to do some tweeking, or something that is not available in LyX, but can be done in LaTeX and it will be painful. So do not even start - its lame. There are also some editors with similar capabilities, but I have my favorite editor, you may have yours - and the scripts works with them all.</p>
<div>
  <pre>
    <code class='ruby'>TEX_FILES = FileList[&quot;*.tex&quot;, &quot;figures/*&quot;, &quot;*.bib&quot;, &quot;*.cls&quot;]
MAIN = &quot;thesis&quot; # name of main file without .tex suffix
MAIN_TEX = &quot;#{MAIN}.tex&quot;
OUT_PDF = &quot;#{MAIN}.pdf&quot;

file OUT_PDF =&gt; TEX_FILES do
  %x{pdflatex -interaction=batchmode #{MAIN_TEX} &gt;/dev/null 2&gt;&amp;1}
  %x{makeindex #{MAIN} &gt;/dev/null 2&gt;&amp;1}
  %x{bibtex #{MAIN} &gt;/dev/null 2&gt;&amp;1}
  %x{pdflatex -interaction=batchmode #{MAIN_TEX} &gt;/dev/null 2&gt;&amp;1}
  %x{bibtex #{MAIN}.gls &gt;/dev/null 2&gt;&amp;1}
  %x{makeindex #{MAIN} &gt;/dev/null 2&gt;&amp;1}
  %x{pdflatex -interaction=batchmode #{MAIN_TEX} &gt;/dev/null 2&gt;&amp;1}
  %x{makeindex #{MAIN} &gt;/dev/null 2&gt;&amp;1}
  %x{bibtex #{MAIN} &gt;/dev/null 2&gt;&amp;1}
  %x{bibtex #{MAIN}.gls &gt;/dev/null 2&gt;&amp;1}
  %x{pdflatex -interaction=batchmode #{MAIN_TEX} &gt;/dev/null 2&gt;&amp;1}
  sh &quot;pdflatex -interaction=batchmode #{MAIN_TEX} &gt;/dev/null&quot;
  cp &quot;#{MAIN}.pdf&quot;
end

desc &quot;Removes unnecessery files&quot;
task :clean do
  rm FileList[&quot;*.aux&quot;,&quot;*.bak&quot;,&quot;*.log&quot;,&quot;*.blg&quot;, &quot;*.bbl&quot;, &quot;*.toc&quot;, &quot;*.out&quot;, &quot;*.idx&quot;, &quot;*.ilg&quot;, &quot;*.ind&quot;, &quot;#{THESIS}.pdf&quot;, &quot;*.dep&quot;, &quot;*.glo&quot;, &quot;*.gls&quot;]
end

task :default =&gt; [:run]

&quot;Open text editor to edit files&quot;
task :edit do
  [&quot;$EDITOR&quot;, &quot;mate&quot;, &quot;vim&quot;, &quot;emacs&quot;].find do |editor|
    system &quot;#{editor} *tex *bib Rakefile&quot;
  end or puts &quot;Unable to find text editor.&quot;
end

task :run do
  t = Rake::Task[OUT_PDF]
  loop do
    begin
      t.reenable
      t.invoke
    rescue =&gt; e
      puts &quot;Error: #{e}, sleeping for 15 seconds.&quot;
      Kernel.sleep 15
    end
    Kernel.sleep 1      
  end
end

desc &quot;Shows Thesis&quot;
task :view =&gt; [OUT_PDF] do
  [&quot;open&quot;, &quot;okular&quot;, &quot;kpdf&quot;, &quot;acroread&quot;].find do |viewer|
    system &quot;#{viewer} #{OUT_PDF}&quot;
  end or
  puts &quot;Unable to find any pdf viewer.&quot;
end</code>
  </pre>
</div>
    </div>
    <div id="related">
      Related posts:
      
      <a href="/Mercurial/rake/subrepositories/2010/01/16/Mercurial-subrepos.html">2010-01-16 Rakefile for dealing with mercurial subrepos</a><br />
      
    </div>
  </body>
</html>